<launch>

  <!-- ════════════════════════════════════════════════════════════
       navigation.launch
       Loads a saved map, localises the robot using AMCL,
       and starts move_base for autonomous point-to-point navigation.

       Prerequisites:
         1. arjuna_sim.launch must be running
         2. A saved map must exist at:
               ~/ros_sim/src/arjuna_gazebo/maps/my_map.yaml
            If no map saved yet — run slam_mapping.launch first,
            drive around, then save.

       After launching:
         - Open rviz and set a 2D Nav Goal to navigate to a point
         - OR run go_to_point.py for scripted single-point navigation
         - OR run multi_point_nav.py for waypoint navigation

       Topics:
         Input:  /scan  /odom  /tf
         Output: /cmd_vel (robot moves autonomously)
                 /map     (loaded map)
                 /amcl_pose (robot estimated position)
  ════════════════════════════════════════════════════════════ -->

  <!-- ── Load saved map ──────────────────────────────────────── -->
  <node pkg="map_server" type="map_server" name="map_server"
        args="$(find arjuna_gazebo)/maps/my_map.yaml"
        output="screen"/>

  <!-- ── AMCL — localise robot on the loaded map ─────────────── -->
  <node pkg="amcl" type="amcl" name="amcl" output="screen">
    <rosparam file="$(find arjuna_gazebo)/config/amcl_params.yaml" command="load"/>
  </node>

  <!-- ── move_base — path planning + autonomous driving ─────── -->
  <node pkg="move_base" type="move_base" name="move_base" output="screen">

    <!-- General move_base settings -->
    <rosparam file="$(find arjuna_gazebo)/config/move_base_params.yaml"      command="load"/>

    <!-- Costmap settings (shared common + individual) -->
    <rosparam file="$(find arjuna_gazebo)/config/costmap_common_params.yaml"  command="load" ns="global_costmap"/>
    <rosparam file="$(find arjuna_gazebo)/config/costmap_common_params.yaml"  command="load" ns="local_costmap"/>
    <rosparam file="$(find arjuna_gazebo)/config/global_costmap_params.yaml"  command="load"/>
    <rosparam file="$(find arjuna_gazebo)/config/local_costmap_params.yaml"   command="load"/>

    <!-- Local planner (DWA) settings -->
    <rosparam file="$(find arjuna_gazebo)/config/base_local_planner_params.yaml" command="load"/>

  </node>

</launch>
